/* Form events - Opened */

CHAR bstatus[20];


WinQueryDlgItemText(hwndMainDlg, 1002, sizeof(bstatus), bstatus);
if( strcmp(bstatus, "Listen OFF") == 0 )
   {
   MLISTENWASOFF = TRUE;
   WinSendMsg(hwndMainF, WM_COMMAND, MPFROM2SHORT(1002,2345), 0);
   }
else   
   MLISTENWASOFF = FALSE;
   

{
SWP swp, swpD;
int dtWidth;
int offX, offY;
dtWidth = WinQuerySysValue(HWND_DESKTOP,SV_CXSCREEN);
offX = 50;
offY = 70;
WinQueryWindowPos(WinQueryWindow(hwndDlg, QW_OWNER), (PSWP) &swp);
WinQueryWindowPos(hwndDlg, (PSWP) &swpD);
if( swp.x < 5 )
   swp.x += ((-swp.x) + 1); 
if( (swp.x+offX+swpD.cx) > (dtWidth-5) )
   {
   int over;
   over = (swp.x+offX+swpD.cx) - (dtWidth-5);
   offX = - (offX+over);   
   }
if( (swp.y-70) < 5 )
   offY = - offY; 
WinSetWindowPos(hwndDlg, HWND_TOP, 
                swp.x+offX, swp.y-offY, 0, 0,
		SWP_ACTIVATE | SWP_MOVE | SWP_SHOW );
}

WinSetDlgItemText(hwndDlg, 1002, guestIP);


